{"ast":null,"code":"import * as i0 from \"@angular/core\";\nimport * as i1 from \"./../services/product.service\";\nimport * as i2 from \"@angular/forms\";\nimport * as i3 from \"./../services/authentication.service\";\nimport * as i4 from \"@angular/router\";\nimport * as i5 from \"@angular/common\";\nfunction ProductsComponent_nav_1_Template(rf, ctx) {\n  if (rf & 1) {\n    const _r5 = i0.ɵɵgetCurrentView();\n    i0.ɵɵelementStart(0, \"nav\", 4)(1, \"button\", 5);\n    i0.ɵɵlistener(\"click\", function ProductsComponent_nav_1_Template_button_click_1_listener() {\n      i0.ɵɵrestoreView(_r5);\n      const ctx_r4 = i0.ɵɵnextContext();\n      return i0.ɵɵresetView(ctx_r4.handleNewProduct());\n    });\n    i0.ɵɵtext(2, \" New product \");\n    i0.ɵɵelementEnd()();\n  }\n}\nfunction ProductsComponent_ng_template_2_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"div\", 6);\n    i0.ɵɵtext(1);\n    i0.ɵɵelementEnd();\n  }\n  if (rf & 2) {\n    const ctx_r2 = i0.ɵɵnextContext();\n    i0.ɵɵadvance(1);\n    i0.ɵɵtextInterpolate(ctx_r2.errorMessage);\n  }\n}\nfunction ProductsComponent_div_4_tr_22_td_9_Template(rf, ctx) {\n  if (rf & 1) {\n    const _r14 = i0.ɵɵgetCurrentView();\n    i0.ɵɵelementStart(0, \"td\")(1, \"div\", 23);\n    i0.ɵɵlistener(\"click\", function ProductsComponent_div_4_tr_22_td_9_Template_div_click_1_listener() {\n      i0.ɵɵrestoreView(_r14);\n      const p_r8 = i0.ɵɵnextContext().$implicit;\n      const ctx_r12 = i0.ɵɵnextContext(2);\n      return i0.ɵɵresetView(ctx_r12.handleToggleProductPromotion(p_r8.id));\n    });\n    i0.ɵɵtext(2);\n    i0.ɵɵelementEnd()();\n  }\n  if (rf & 2) {\n    const p_r8 = i0.ɵɵnextContext().$implicit;\n    i0.ɵɵadvance(1);\n    i0.ɵɵproperty(\"ngClass\", \"btn btn-\" + (p_r8.promotion ? \"danger\" : \"success\"));\n    i0.ɵɵadvance(1);\n    i0.ɵɵtextInterpolate1(\" Set promo \", p_r8.promotion ? \"Off\" : \"On\", \" \");\n  }\n}\nfunction ProductsComponent_div_4_tr_22_td_10_Template(rf, ctx) {\n  if (rf & 1) {\n    const _r18 = i0.ɵɵgetCurrentView();\n    i0.ɵɵelementStart(0, \"td\")(1, \"button\", 24);\n    i0.ɵɵlistener(\"click\", function ProductsComponent_div_4_tr_22_td_10_Template_button_click_1_listener() {\n      i0.ɵɵrestoreView(_r18);\n      const p_r8 = i0.ɵɵnextContext().$implicit;\n      const ctx_r16 = i0.ɵɵnextContext(2);\n      return i0.ɵɵresetView(ctx_r16.handleEditProduct(p_r8));\n    });\n    i0.ɵɵelement(2, \"i\", 25);\n    i0.ɵɵelementEnd()();\n  }\n}\nfunction ProductsComponent_div_4_tr_22_td_11_Template(rf, ctx) {\n  if (rf & 1) {\n    const _r21 = i0.ɵɵgetCurrentView();\n    i0.ɵɵelementStart(0, \"td\")(1, \"button\", 26);\n    i0.ɵɵlistener(\"click\", function ProductsComponent_div_4_tr_22_td_11_Template_button_click_1_listener() {\n      i0.ɵɵrestoreView(_r21);\n      const p_r8 = i0.ɵɵnextContext().$implicit;\n      const ctx_r19 = i0.ɵɵnextContext(2);\n      return i0.ɵɵresetView(ctx_r19.handleDeleteProduct(p_r8));\n    });\n    i0.ɵɵelement(2, \"i\", 27);\n    i0.ɵɵelementEnd()();\n  }\n}\nfunction ProductsComponent_div_4_tr_22_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"tr\")(1, \"td\");\n    i0.ɵɵtext(2);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(3, \"td\");\n    i0.ɵɵtext(4);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(5, \"td\");\n    i0.ɵɵtext(6);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(7, \"td\");\n    i0.ɵɵelement(8, \"i\", 21);\n    i0.ɵɵelementEnd();\n    i0.ɵɵtemplate(9, ProductsComponent_div_4_tr_22_td_9_Template, 3, 2, \"td\", 22);\n    i0.ɵɵtemplate(10, ProductsComponent_div_4_tr_22_td_10_Template, 3, 0, \"td\", 22);\n    i0.ɵɵtemplate(11, ProductsComponent_div_4_tr_22_td_11_Template, 3, 0, \"td\", 22);\n    i0.ɵɵelementEnd();\n  }\n  if (rf & 2) {\n    const p_r8 = ctx.$implicit;\n    const ctx_r6 = i0.ɵɵnextContext(2);\n    i0.ɵɵadvance(2);\n    i0.ɵɵtextInterpolate(p_r8.id);\n    i0.ɵɵadvance(2);\n    i0.ɵɵtextInterpolate(p_r8.name);\n    i0.ɵɵadvance(2);\n    i0.ɵɵtextInterpolate(p_r8.price);\n    i0.ɵɵadvance(2);\n    i0.ɵɵproperty(\"ngClass\", \"text-danger bi bi-heart\" + (p_r8.promotion ? \"-fill\" : \"\"));\n    i0.ɵɵadvance(1);\n    i0.ɵɵproperty(\"ngIf\", ctx_r6.authService.hasRole(\"ADMIN\"));\n    i0.ɵɵadvance(1);\n    i0.ɵɵproperty(\"ngIf\", ctx_r6.authService.hasRole(\"ADMIN\"));\n    i0.ɵɵadvance(1);\n    i0.ɵɵproperty(\"ngIf\", ctx_r6.authService.hasRole(\"ADMIN\"));\n  }\n}\nfunction ProductsComponent_div_4_li_28_Template(rf, ctx) {\n  if (rf & 1) {\n    const _r25 = i0.ɵɵgetCurrentView();\n    i0.ɵɵelementStart(0, \"li\", 28);\n    i0.ɵɵlistener(\"click\", function ProductsComponent_div_4_li_28_Template_li_click_0_listener() {\n      const restoredCtx = i0.ɵɵrestoreView(_r25);\n      const i_r23 = restoredCtx.index;\n      const ctx_r24 = i0.ɵɵnextContext(2);\n      return i0.ɵɵresetView(ctx_r24.handleGetPageProduct(ctx_r24.searchFormGroup.value.keyword, i_r23, ctx_r24.pageSize));\n    });\n    i0.ɵɵtext(1);\n    i0.ɵɵelementEnd();\n  }\n  if (rf & 2) {\n    const i_r23 = ctx.index;\n    const ctx_r7 = i0.ɵɵnextContext(2);\n    i0.ɵɵproperty(\"ngClass\", i_r23 === ctx_r7.currentPage ? \"btn-info\" : \"btn-outline-info\");\n    i0.ɵɵadvance(1);\n    i0.ɵɵtextInterpolate1(\" \", i_r23 + 1, \" \");\n  }\n}\nconst _c0 = function () {\n  return [];\n};\nfunction ProductsComponent_div_4_Template(rf, ctx) {\n  if (rf & 1) {\n    const _r27 = i0.ɵɵgetCurrentView();\n    i0.ɵɵelementStart(0, \"div\", 7)(1, \"div\", 8);\n    i0.ɵɵtext(2, \"Products List\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(3, \"div\", 9)(4, \"form\", 10);\n    i0.ɵɵlistener(\"ngSubmit\", function ProductsComponent_div_4_Template_form_ngSubmit_4_listener() {\n      i0.ɵɵrestoreView(_r27);\n      const ctx_r26 = i0.ɵɵnextContext();\n      return i0.ɵɵresetView(ctx_r26.handleSearchPageProductsByKeyword());\n    });\n    i0.ɵɵelementStart(5, \"div\", 11)(6, \"label\", 12);\n    i0.ɵɵtext(7, \"Keyword\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵelement(8, \"input\", 13);\n    i0.ɵɵelementStart(9, \"button\", 14);\n    i0.ɵɵelement(10, \"i\", 15);\n    i0.ɵɵelementEnd()()();\n    i0.ɵɵelementStart(11, \"table\", 16)(12, \"thead\")(13, \"tr\")(14, \"th\");\n    i0.ɵɵtext(15, \"ID\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(16, \"th\");\n    i0.ɵɵtext(17, \"Product name\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(18, \"th\");\n    i0.ɵɵtext(19, \"Product price\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵelement(20, \"th\", 17);\n    i0.ɵɵelementEnd()();\n    i0.ɵɵelementStart(21, \"tbody\");\n    i0.ɵɵtemplate(22, ProductsComponent_div_4_tr_22_Template, 12, 7, \"tr\", 18);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(23, \"div\", 0);\n    i0.ɵɵtext(24);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(25, \"div\", 0);\n    i0.ɵɵtext(26);\n    i0.ɵɵelementEnd()();\n    i0.ɵɵelementStart(27, \"ul\", 19);\n    i0.ɵɵtemplate(28, ProductsComponent_div_4_li_28_Template, 2, 2, \"li\", 20);\n    i0.ɵɵelementEnd()()();\n  }\n  if (rf & 2) {\n    const ctx_r3 = i0.ɵɵnextContext();\n    i0.ɵɵadvance(4);\n    i0.ɵɵproperty(\"formGroup\", ctx_r3.searchFormGroup);\n    i0.ɵɵadvance(18);\n    i0.ɵɵproperty(\"ngForOf\", ctx_r3.products);\n    i0.ɵɵadvance(2);\n    i0.ɵɵtextInterpolate2(\"\", ctx_r3.currentPage + 1, \" / \", ctx_r3.totalPages, \"\");\n    i0.ɵɵadvance(2);\n    i0.ɵɵtextInterpolate1(\"\", ctx_r3.pageSize, \" per page\");\n    i0.ɵɵadvance(2);\n    i0.ɵɵproperty(\"ngForOf\", i0.ɵɵpureFunction0(6, _c0).constructor(ctx_r3.totalPages));\n  }\n}\nexport class ProductsComponent {\n  constructor(productService, formBuilder, authService, router) {\n    this.productService = productService;\n    this.formBuilder = formBuilder;\n    this.authService = authService;\n    this.router = router;\n    this.currentPage = 0;\n    this.pageSize = 5;\n    this.totalPages = 0;\n    this.handleToggleProductPromotion = productID => {\n      this.productService.setProductPromotion(productID).subscribe({\n        next: data => {},\n        error: error => this.errorMessage = error.message\n      });\n    };\n    this.handleGetAllProducts = () => {\n      this.productService.getAllProducts().subscribe({\n        next: data => {\n          this.products = data;\n        },\n        error: error => {\n          this.errorMessage = error.message;\n        }\n      });\n    };\n    this.handleGetPageProduct = (keyword, page, size) => {\n      this.productService.getPageProductsByKeyword(keyword, page, size).subscribe({\n        next: data => {\n          this.products = data._embedded.products;\n          this.currentPage = data.page.number;\n          this.pageSize = data.size;\n          this.totalPages = data.totalPages;\n        },\n        error: error => this.errorMessage = error.message\n      });\n    };\n    this.handleSearchProductSubmit = () => {\n      this.productService.getProductsByKeyword(this.searchFormGroup.value.keyword).subscribe({\n        next: data => {\n          this.products = data;\n        },\n        error: error => {\n          this.errorMessage = error.message;\n        }\n      });\n    };\n    this.handleSearchPageProductsByKeyword = () => {\n      this.currentPage = 0;\n      this.productService.getPageProductsByKeyword(this.searchFormGroup.value.keyword, this.currentPage, this.pageSize).subscribe({\n        next: data => {\n          this.products = data.products;\n          this.currentPage = data.page;\n          this.pageSize = data.size;\n          this.totalPages = data.totalPages;\n        },\n        error: error => {\n          this.errorMessage = error.message;\n        }\n      });\n    };\n  }\n  ngOnInit() {\n    this.searchFormGroup = this.formBuilder.group({\n      keyword: this.formBuilder.control(\"\")\n    });\n    this.handleGetPageProduct(\"\", this.currentPage, this.pageSize);\n    //this.handleGetAllProducts();\n  }\n\n  handleDeleteProduct(product) {\n    if (confirm(\"Are you sure you want to delete this product\")) this.productService.deleteProduct(product.id).subscribe({\n      next: data => {\n        let index = this.products.indexOf(product);\n        this.products.splice(index, 1);\n      },\n      error: error => this.errorMessage = error.message\n    });\n  }\n  handleNewProduct() {\n    this.router.navigateByUrl(\"/admin/new-product\");\n  }\n  handleEditProduct(product) {\n    this.router.navigateByUrl(`/admin/edit-product/${product.id}`);\n  }\n  static #_ = this.ɵfac = function ProductsComponent_Factory(t) {\n    return new (t || ProductsComponent)(i0.ɵɵdirectiveInject(i1.ProductService), i0.ɵɵdirectiveInject(i2.FormBuilder), i0.ɵɵdirectiveInject(i3.AuthenticationService), i0.ɵɵdirectiveInject(i4.Router));\n  };\n  static #_2 = this.ɵcmp = /*@__PURE__*/i0.ɵɵdefineComponent({\n    type: ProductsComponent,\n    selectors: [[\"app-products\"]],\n    decls: 5,\n    vars: 3,\n    consts: [[1, \"container\"], [\"class\", \"p-2 m-2 border border-info\", 4, \"ngIf\"], [\"errors\", \"\"], [\"class\", \"card\", 4, \"ngIf\", \"ngIfElse\"], [1, \"p-2\", \"m-2\", \"border\", \"border-info\"], [1, \"btn\", \"btn-outline-info\", 3, \"click\"], [1, \"text-danger\"], [1, \"card\"], [1, \"card-header\"], [1, \"card-body\"], [1, \"form\", 3, \"formGroup\", \"ngSubmit\"], [1, \"input-group\"], [1, \"input-group-text\"], [\"type\", \"text\", \"formControlName\", \"keyword\", 1, \"form-control\"], [1, \"btn\", \"btn-info\"], [1, \"bi\", \"bi-search\"], [1, \"table\"], [\"colspan\", \"2\"], [4, \"ngFor\", \"ngForOf\"], [1, \"nav\", \"nav-pills\"], [\"class\", \"btn ms-1 mt-1\", 3, \"ngClass\", \"click\", 4, \"ngFor\", \"ngForOf\"], [3, \"ngClass\"], [4, \"ngIf\"], [3, \"ngClass\", \"click\"], [1, \"btn\", \"btn-warning\", 3, \"click\"], [1, \"bi\", \"bi-pencil\"], [1, \"btn\", \"btn-danger\", 3, \"click\"], [1, \"bi\", \"bi-trash\"], [1, \"btn\", \"ms-1\", \"mt-1\", 3, \"ngClass\", \"click\"]],\n    template: function ProductsComponent_Template(rf, ctx) {\n      if (rf & 1) {\n        i0.ɵɵelementStart(0, \"div\", 0);\n        i0.ɵɵtemplate(1, ProductsComponent_nav_1_Template, 3, 0, \"nav\", 1);\n        i0.ɵɵtemplate(2, ProductsComponent_ng_template_2_Template, 2, 1, \"ng-template\", null, 2, i0.ɵɵtemplateRefExtractor);\n        i0.ɵɵtemplate(4, ProductsComponent_div_4_Template, 29, 7, \"div\", 3);\n        i0.ɵɵelementEnd();\n      }\n      if (rf & 2) {\n        const _r1 = i0.ɵɵreference(3);\n        i0.ɵɵadvance(1);\n        i0.ɵɵproperty(\"ngIf\", ctx.authService.hasRole(\"ADMIN\"));\n        i0.ɵɵadvance(3);\n        i0.ɵɵproperty(\"ngIf\", ctx.products)(\"ngIfElse\", _r1);\n      }\n    },\n    dependencies: [i5.NgClass, i5.NgForOf, i5.NgIf, i2.ɵNgNoValidate, i2.DefaultValueAccessor, i2.NgControlStatus, i2.NgControlStatusGroup, i2.FormGroupDirective, i2.FormControlName],\n    styles: [\"\\n/*# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IiIsInNvdXJjZVJvb3QiOiIifQ== */\"]\n  });\n}","map":{"version":3,"mappings":"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","names":["i0","ProductsComponent","constructor","productService","formBuilder","authService","router","productID","setProductPromotion","subscribe","next","data","error","errorMessage","message","getAllProducts","products","keyword","page","size","getPageProductsByKeyword","_embedded","currentPage","number","pageSize","totalPages","getProductsByKeyword","searchFormGroup","value","ngOnInit","group","control","handleGetPageProduct","handleDeleteProduct","product","confirm","deleteProduct","id","index","indexOf","splice","handleNewProduct","navigateByUrl","handleEditProduct","selectors","decls","vars","consts","template"],"sourceRoot":"","sources":["/Users/achrafbilal/Documents/GitHub/tp-controle-spring-boot/front/src/app/products/products.component.html","/Users/achrafbilal/Documents/GitHub/tp-controle-spring-boot/front/src/app/products/products.component.ts"],"sourcesContent":["<div class=\"container\">\n  <nav class=\"p-2 m-2 border border-info\" *ngIf=\"authService.hasRole('ADMIN')\">\n    <button class=\"btn btn-outline-info\" (click)=\"handleNewProduct()\">\n      New product\n    </button>\n  </nav>\n  <ng-template #errors>\n    <div class=\"text-danger\">{{ errorMessage }}</div>\n  </ng-template>\n  <div class=\"card\" *ngIf=\"products; else errors\">\n    <div class=\"card-header\">Products List</div>\n    <div class=\"card-body\">\n      <form\n        class=\"form\"\n        [formGroup]=\"searchFormGroup\"\n        (ngSubmit)=\"handleSearchPageProductsByKeyword()\"\n      >\n        <div class=\"input-group\">\n          <label class=\"input-group-text\">Keyword</label>\n          <input type=\"text\" class=\"form-control\" formControlName=\"keyword\" />\n          <button class=\"btn btn-info\">\n            <i class=\"bi bi-search\"></i>\n          </button>\n        </div>\n      </form>\n      <table class=\"table\">\n        <thead>\n          <tr>\n            <th>ID</th>\n            <th>Product name</th>\n            <th>Product price</th>\n            <th colspan=\"2\"></th>\n          </tr>\n        </thead>\n        <tbody>\n          <tr *ngFor=\"let p of products\">\n            <td>{{ p.id }}</td>\n            <td>{{ p.name }}</td>\n            <td>{{ p.price }}</td>\n            <td>\n              <i\n                [ngClass]=\"\n                  'text-danger bi bi-heart' + (p.promotion ? '-fill' : '')\n                \"\n              ></i>\n            </td>\n            <td *ngIf=\"authService.hasRole('ADMIN')\">\n              <div\n                [ngClass]=\"'btn btn-' + (p.promotion ? 'danger' : 'success')\"\n                (click)=\"handleToggleProductPromotion(p.id)\"\n              >\n                Set promo {{ p.promotion ? \"Off\" : \"On\" }}\n              </div>\n            </td>\n            <td *ngIf=\"authService.hasRole('ADMIN')\">\n              <button (click)=\"handleEditProduct(p)\" class=\"btn btn-warning\">\n                <i class=\"bi bi-pencil\"></i>\n              </button>\n            </td>\n            <td *ngIf=\"authService.hasRole('ADMIN')\">\n              <button (click)=\"handleDeleteProduct(p)\" class=\"btn btn-danger\">\n                <i class=\"bi bi-trash\"></i>\n              </button>\n            </td>\n          </tr>\n        </tbody>\n        <div class=\"container\">{{ currentPage + 1 }} / {{ totalPages }}</div>\n        <div class=\"container\">{{ pageSize }} per page</div>\n      </table>\n      <ul class=\"nav nav-pills\">\n        <li\n          class=\"btn ms-1 mt-1\"\n          (click)=\"\n            handleGetPageProduct(searchFormGroup.value.keyword, i, pageSize)\n          \"\n          *ngFor=\"let item of [].constructor(this.totalPages); let i = index\"\n          [ngClass]=\"i === currentPage ? 'btn-info' : 'btn-outline-info'\"\n        >\n          {{ i + 1 }}\n        </li>\n      </ul>\n    </div>\n  </div>\n</div>\n","import { AuthenticationService } from \"./../services/authentication.service\";\nimport { Product, PageProduct } from \"./../model/product.model\";\n\nimport { ProductService } from \"./../services/product.service\";\nimport { Component, OnInit } from \"@angular/core\";\nimport { FormBuilder, FormGroup } from \"@angular/forms\";\nimport { Router } from \"@angular/router\";\n\n@Component({\n  selector: \"app-products\",\n  templateUrl: \"./products.component.html\",\n  styleUrls: [\"./products.component.scss\"],\n})\nexport class ProductsComponent implements OnInit {\n  products!: Array<any>;\n  errorMessage!: String;\n  searchFormGroup!: FormGroup;\n  currentPage: Number = 0;\n  pageSize: Number = 5;\n  totalPages: Number = 0;\n  constructor(\n    private productService: ProductService,\n    private formBuilder: FormBuilder,\n    public authService: AuthenticationService,\n    private router: Router\n  ) {}\n\n  ngOnInit(): void {\n    this.searchFormGroup = this.formBuilder.group({\n      keyword: this.formBuilder.control(\"\"),\n    });\n    this.handleGetPageProduct(\"\", this.currentPage, this.pageSize);\n    //this.handleGetAllProducts();\n  }\n\n  handleDeleteProduct(product: Product) {\n    if (confirm(\"Are you sure you want to delete this product\"))\n      this.productService.deleteProduct(product.id).subscribe({\n        next: (data: boolean) => {\n          let index = this.products.indexOf(product);\n          this.products.splice(index, 1);\n        },\n        error: (error) => (this.errorMessage = error.message),\n      });\n  }\n\n  handleToggleProductPromotion = (productID: string) => {\n    this.productService.setProductPromotion(productID).subscribe({\n      next: (data: boolean) => {},\n      error: (error) => (this.errorMessage = error.message),\n    });\n  };\n\n  handleGetAllProducts = () => {\n    this.productService.getAllProducts().subscribe({\n      next: (data: Array<Product>) => {\n        this.products = data;\n      },\n      error: (error) => {\n        this.errorMessage = error.message;\n      },\n    });\n  };\n  handleGetPageProduct = (keyword: string, page: number, size: number) => {\n    this.productService\n      .getPageProductsByKeyword(keyword, page, size)\n      .subscribe({\n        next: (data) => {\n          this.products = data._embedded.products;\n          this.currentPage = data.page.number;\n          this.pageSize = data.size;\n          this.totalPages = data.totalPages;\n        },\n        error: (error) => (this.errorMessage = error.message),\n      });\n  };\n  handleSearchProductSubmit = () => {\n    this.productService\n      .getProductsByKeyword(this.searchFormGroup.value.keyword)\n      .subscribe({\n        next: (data: Product[]) => {\n          this.products = data;\n        },\n        error: (error) => {\n          this.errorMessage = error.message;\n        },\n      });\n  };\n  handleSearchPageProductsByKeyword = () => {\n    this.currentPage = 0;\n    this.productService\n      .getPageProductsByKeyword(\n        this.searchFormGroup.value.keyword,\n        this.currentPage,\n        this.pageSize\n      )\n      .subscribe({\n        next: (data: PageProduct) => {\n          this.products = data.products;\n          this.currentPage = data.page;\n          this.pageSize = data.size;\n          this.totalPages = data.totalPages;\n        },\n        error: (error) => {\n          this.errorMessage = error.message;\n        },\n      });\n  };\n  handleNewProduct() {\n    this.router.navigateByUrl(\"/admin/new-product\");\n  }\n  handleEditProduct(product: Product) {\n    this.router.navigateByUrl(`/admin/edit-product/${product.id}`);\n  }\n}\n"]},"metadata":{},"sourceType":"module","externalDependencies":[]}