{"ast":null,"code":"import _asyncToGenerator from \"/Users/achrafbilal/Documents/GitHub/tp-controle-spring-boot/front/node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js\";\nimport * as i0 from \"@angular/core\";\nimport * as i1 from \"./../services/bill.service\";\nimport * as i2 from \"@angular/forms\";\nimport * as i3 from \"./../services/security.service\";\nimport * as i4 from \"@angular/router\";\nimport * as i5 from \"@angular/common\";\nfunction BillsComponent_nav_1_Template(rf, ctx) {\n  if (rf & 1) {\n    const _r5 = i0.ɵɵgetCurrentView();\n    i0.ɵɵelementStart(0, \"nav\", 4)(1, \"button\", 5);\n    i0.ɵɵlistener(\"click\", function BillsComponent_nav_1_Template_button_click_1_listener() {\n      i0.ɵɵrestoreView(_r5);\n      const ctx_r4 = i0.ɵɵnextContext();\n      return i0.ɵɵresetView(ctx_r4.handleNewBill());\n    });\n    i0.ɵɵtext(2, \" New bill \");\n    i0.ɵɵelementEnd()();\n  }\n}\nfunction BillsComponent_ng_template_2_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"div\", 6);\n    i0.ɵɵtext(1);\n    i0.ɵɵelementEnd();\n  }\n  if (rf & 2) {\n    const ctx_r2 = i0.ɵɵnextContext();\n    i0.ɵɵadvance(1);\n    i0.ɵɵtextInterpolate(ctx_r2.errorMessage);\n  }\n}\nfunction BillsComponent_div_4_tr_13_td_5_Template(rf, ctx) {\n  if (rf & 1) {\n    const _r14 = i0.ɵɵgetCurrentView();\n    i0.ɵɵelementStart(0, \"td\")(1, \"button\", 16);\n    i0.ɵɵlistener(\"click\", function BillsComponent_div_4_tr_13_td_5_Template_button_click_1_listener() {\n      i0.ɵɵrestoreView(_r14);\n      const p_r8 = i0.ɵɵnextContext().$implicit;\n      const ctx_r12 = i0.ɵɵnextContext(2);\n      return i0.ɵɵresetView(ctx_r12.handleShowBill(p_r8));\n    });\n    i0.ɵɵelement(2, \"i\", 17);\n    i0.ɵɵelementEnd()();\n  }\n}\nfunction BillsComponent_div_4_tr_13_td_6_Template(rf, ctx) {\n  if (rf & 1) {\n    const _r17 = i0.ɵɵgetCurrentView();\n    i0.ɵɵelementStart(0, \"td\")(1, \"button\", 18);\n    i0.ɵɵlistener(\"click\", function BillsComponent_div_4_tr_13_td_6_Template_button_click_1_listener() {\n      i0.ɵɵrestoreView(_r17);\n      const p_r8 = i0.ɵɵnextContext().$implicit;\n      const ctx_r15 = i0.ɵɵnextContext(2);\n      return i0.ɵɵresetView(ctx_r15.handleEditBill(p_r8));\n    });\n    i0.ɵɵelement(2, \"i\", 19);\n    i0.ɵɵelementEnd()();\n  }\n}\nfunction BillsComponent_div_4_tr_13_td_7_Template(rf, ctx) {\n  if (rf & 1) {\n    const _r20 = i0.ɵɵgetCurrentView();\n    i0.ɵɵelementStart(0, \"td\")(1, \"button\", 20);\n    i0.ɵɵlistener(\"click\", function BillsComponent_div_4_tr_13_td_7_Template_button_click_1_listener() {\n      i0.ɵɵrestoreView(_r20);\n      const p_r8 = i0.ɵɵnextContext().$implicit;\n      const ctx_r18 = i0.ɵɵnextContext(2);\n      return i0.ɵɵresetView(ctx_r18.handleDeleteBill(p_r8));\n    });\n    i0.ɵɵelement(2, \"i\", 21);\n    i0.ɵɵelementEnd()();\n  }\n}\nconst _c0 = function () {\n  return [];\n};\nfunction BillsComponent_div_4_tr_13_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"tr\")(1, \"td\");\n    i0.ɵɵtext(2);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(3, \"td\");\n    i0.ɵɵtext(4);\n    i0.ɵɵelementEnd();\n    i0.ɵɵtemplate(5, BillsComponent_div_4_tr_13_td_5_Template, 3, 0, \"td\", 15);\n    i0.ɵɵtemplate(6, BillsComponent_div_4_tr_13_td_6_Template, 3, 0, \"td\", 15);\n    i0.ɵɵtemplate(7, BillsComponent_div_4_tr_13_td_7_Template, 3, 0, \"td\", 15);\n    i0.ɵɵelementEnd();\n  }\n  if (rf & 2) {\n    const p_r8 = ctx.$implicit;\n    const ctx_r6 = i0.ɵɵnextContext(2);\n    i0.ɵɵadvance(2);\n    i0.ɵɵtextInterpolate(p_r8.id);\n    i0.ɵɵadvance(2);\n    i0.ɵɵtextInterpolate(p_r8.billingDate);\n    i0.ɵɵadvance(1);\n    i0.ɵɵproperty(\"ngIf\", ctx_r6.authService.hasRoleIn(i0.ɵɵpureFunction0(5, _c0)) || true);\n    i0.ɵɵadvance(1);\n    i0.ɵɵproperty(\"ngIf\", ctx_r6.authService.hasRoleIn(i0.ɵɵpureFunction0(6, _c0)) || true);\n    i0.ɵɵadvance(1);\n    i0.ɵɵproperty(\"ngIf\", ctx_r6.authService.hasRoleIn(i0.ɵɵpureFunction0(7, _c0)) || true);\n  }\n}\nfunction BillsComponent_div_4_li_19_Template(rf, ctx) {\n  if (rf & 1) {\n    const _r24 = i0.ɵɵgetCurrentView();\n    i0.ɵɵelementStart(0, \"li\", 22);\n    i0.ɵɵlistener(\"click\", function BillsComponent_div_4_li_19_Template_li_click_0_listener() {\n      const restoredCtx = i0.ɵɵrestoreView(_r24);\n      const i_r22 = restoredCtx.index;\n      const ctx_r23 = i0.ɵɵnextContext(2);\n      return i0.ɵɵresetView(ctx_r23.handleGetPageBill(i_r22, ctx_r23.pageSize));\n    });\n    i0.ɵɵtext(1);\n    i0.ɵɵelementEnd();\n  }\n  if (rf & 2) {\n    const i_r22 = ctx.index;\n    const ctx_r7 = i0.ɵɵnextContext(2);\n    i0.ɵɵproperty(\"ngClass\", i_r22 === ctx_r7.currentPage ? \"btn-info\" : \"btn-outline-info\");\n    i0.ɵɵadvance(1);\n    i0.ɵɵtextInterpolate1(\" \", i_r22 + 1, \" \");\n  }\n}\nfunction BillsComponent_div_4_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"div\", 7)(1, \"div\", 8);\n    i0.ɵɵtext(2, \"Bills List\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(3, \"div\", 9)(4, \"table\", 10)(5, \"thead\")(6, \"tr\")(7, \"th\");\n    i0.ɵɵtext(8, \"ID\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(9, \"th\");\n    i0.ɵɵtext(10, \"Billing date\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵelement(11, \"th\", 11);\n    i0.ɵɵelementEnd()();\n    i0.ɵɵelementStart(12, \"tbody\");\n    i0.ɵɵtemplate(13, BillsComponent_div_4_tr_13_Template, 8, 8, \"tr\", 12);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(14, \"div\", 0);\n    i0.ɵɵtext(15);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(16, \"div\", 0);\n    i0.ɵɵtext(17);\n    i0.ɵɵelementEnd()();\n    i0.ɵɵelementStart(18, \"ul\", 13);\n    i0.ɵɵtemplate(19, BillsComponent_div_4_li_19_Template, 2, 2, \"li\", 14);\n    i0.ɵɵelementEnd()()();\n  }\n  if (rf & 2) {\n    const ctx_r3 = i0.ɵɵnextContext();\n    i0.ɵɵadvance(13);\n    i0.ɵɵproperty(\"ngForOf\", ctx_r3.bills);\n    i0.ɵɵadvance(2);\n    i0.ɵɵtextInterpolate2(\"\", ctx_r3.currentPage + 1, \" / \", ctx_r3.totalPages, \"\");\n    i0.ɵɵadvance(2);\n    i0.ɵɵtextInterpolate1(\"\", ctx_r3.pageSize, \" per page\");\n    i0.ɵɵadvance(2);\n    i0.ɵɵproperty(\"ngForOf\", i0.ɵɵpureFunction0(5, _c0).constructor(ctx_r3.totalPages));\n  }\n}\nexport class BillsComponent {\n  constructor(billService, formBuilder, authService, activatedRoute, router) {\n    this.billService = billService;\n    this.formBuilder = formBuilder;\n    this.authService = authService;\n    this.activatedRoute = activatedRoute;\n    this.router = router;\n    this.currentPage = 0;\n    this.pageSize = 5;\n    this.totalPages = 0;\n    this.totalElements = 0;\n    this.roundNumber = value => {\n      return Math.round(value);\n    };\n    this.handleGetPageBill = (page, size) => {\n      this.billService.getPageBills(page, size).subscribe({\n        next: data => {\n          console.log(data);\n          const {\n            content,\n            number,\n            size,\n            totalPages,\n            totalElements\n          } = data;\n          this.bills = content;\n          this.currentPage = number;\n          this.pageSize = size;\n          this.totalPages = totalPages;\n          this.totalElements = totalElements;\n        },\n        error: error => this.errorMessage = error.message\n      });\n    };\n    this.handleGetCustomerPageBill = (customerID, page, size) => {\n      this.billService.getBillsByCustomerId(customerID, page, size).subscribe({\n        next: data => {\n          console.log(data);\n          const {\n            content,\n            number,\n            size,\n            totalPages,\n            totalElements\n          } = data;\n          this.bills = content;\n          this.currentPage = number;\n          this.pageSize = size;\n          this.totalPages = totalPages;\n          this.totalElements = totalElements;\n        },\n        error: error => this.errorMessage = error.message\n      });\n    };\n  }\n  ngOnInit() {\n    const params = this.activatedRoute.snapshot.params;\n    this.searchFormGroup = this.formBuilder.group({\n      keyword: this.formBuilder.control(\"\")\n    });\n    if (params[\"id\"]) {\n      this.handleGetCustomerPageBill(Number(params[\"id\"]), this.currentPage, this.pageSize);\n    } else {\n      this.handleGetPageBill(this.currentPage, this.pageSize);\n    }\n  }\n  handleDeleteBill(bill) {\n    var _this = this;\n    return _asyncToGenerator(function* () {\n      if (confirm(\"Are you sure you want to delete this bill\")) {\n        _this.billService.deleteBill(bill.id).subscribe(d => {\n          _this.billService.getPageBills(_this.currentPage, _this.pageSize).subscribe({\n            next: data => {\n              const {\n                content,\n                number,\n                size,\n                totalPages,\n                totalElements\n              } = data;\n              _this.bills = content;\n              _this.currentPage = number;\n              _this.pageSize = size;\n              _this.totalPages = totalPages;\n              _this.totalElements = totalElements;\n            },\n            error: error => _this.errorMessage = error.message\n          });\n        });\n      }\n    })();\n  }\n  handleNewBill() {\n    this.router.navigateByUrl(\"/admin/new-bill\");\n  }\n  handleEditBill(bill) {\n    this.router.navigateByUrl(`/admin/edit-bill/${bill.id}`);\n  }\n  handleShowBill(bill) {\n    this.router.navigateByUrl(`/admin/show-bill/${bill.id}`);\n  }\n  static #_ = this.ɵfac = function BillsComponent_Factory(t) {\n    return new (t || BillsComponent)(i0.ɵɵdirectiveInject(i1.BillService), i0.ɵɵdirectiveInject(i2.FormBuilder), i0.ɵɵdirectiveInject(i3.SecurityService), i0.ɵɵdirectiveInject(i4.ActivatedRoute), i0.ɵɵdirectiveInject(i4.Router));\n  };\n  static #_2 = this.ɵcmp = /*@__PURE__*/i0.ɵɵdefineComponent({\n    type: BillsComponent,\n    selectors: [[\"app-bills\"]],\n    decls: 5,\n    vars: 4,\n    consts: [[1, \"container\"], [\"class\", \"p-2 m-2 border border-info\", 4, \"ngIf\"], [\"errors\", \"\"], [\"class\", \"card\", 4, \"ngIf\", \"ngIfElse\"], [1, \"p-2\", \"m-2\", \"border\", \"border-info\"], [1, \"btn\", \"btn-outline-info\", 3, \"click\"], [1, \"text-danger\"], [1, \"card\"], [1, \"card-header\"], [1, \"card-body\"], [1, \"table\"], [\"colspan\", \"2\"], [4, \"ngFor\", \"ngForOf\"], [1, \"nav\", \"nav-pills\"], [\"class\", \"btn ms-1 mt-1\", 3, \"ngClass\", \"click\", 4, \"ngFor\", \"ngForOf\"], [4, \"ngIf\"], [1, \"btn\", \"btn-info\", 3, \"click\"], [1, \"bi\", \"bi-eye-fill\"], [1, \"btn\", \"btn-warning\", 3, \"click\"], [1, \"bi\", \"bi-pencil\"], [1, \"btn\", \"btn-danger\", 3, \"click\"], [1, \"bi\", \"bi-trash\"], [1, \"btn\", \"ms-1\", \"mt-1\", 3, \"ngClass\", \"click\"]],\n    template: function BillsComponent_Template(rf, ctx) {\n      if (rf & 1) {\n        i0.ɵɵelementStart(0, \"div\", 0);\n        i0.ɵɵtemplate(1, BillsComponent_nav_1_Template, 3, 0, \"nav\", 1);\n        i0.ɵɵtemplate(2, BillsComponent_ng_template_2_Template, 2, 1, \"ng-template\", null, 2, i0.ɵɵtemplateRefExtractor);\n        i0.ɵɵtemplate(4, BillsComponent_div_4_Template, 20, 6, \"div\", 3);\n        i0.ɵɵelementEnd();\n      }\n      if (rf & 2) {\n        const _r1 = i0.ɵɵreference(3);\n        i0.ɵɵadvance(1);\n        i0.ɵɵproperty(\"ngIf\", ctx.authService.hasRoleIn(i0.ɵɵpureFunction0(3, _c0)) || true);\n        i0.ɵɵadvance(3);\n        i0.ɵɵproperty(\"ngIf\", ctx.bills)(\"ngIfElse\", _r1);\n      }\n    },\n    dependencies: [i5.NgClass, i5.NgForOf, i5.NgIf],\n    styles: [\"\\n/*# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IiIsInNvdXJjZVJvb3QiOiIifQ== */\"]\n  });\n}","map":{"version":3,"mappings":";;;;;;;;;;IACEA,8BAGC;IACsCA;MAAAA;MAAA;MAAA,OAASA,qCAAe;IAAA,EAAC;IAC5DA,0BACF;IAAAA,iBAAS;;;;;IAGTA,8BAAyB;IAAAA,YAAkB;IAAAA,iBAAM;;;;IAAxBA,eAAkB;IAAlBA,yCAAkB;;;;;;IAiBnCA,0BAA8C;IACpCA;MAAAA;MAAA;MAAA;MAAA,OAASA,2CAAiB;IAAA,EAAC;IACjCA,wBAA8B;IAChCA,iBAAS;;;;;;IAEXA,0BAA8C;IACpCA;MAAAA;MAAA;MAAA;MAAA,OAASA,2CAAiB;IAAA,EAAC;IACjCA,wBAA4B;IAC9BA,iBAAS;;;;;;IAEXA,0BAA8C;IACpCA;MAAAA;MAAA;MAAA;MAAA,OAASA,6CAAmB;IAAA,EAAC;IACnCA,wBAA2B;IAC7BA,iBAAS;;;;;;;;IAhBbA,0BAA4B;IACtBA,YAAU;IAAAA,iBAAK;IACnBA,0BAAI;IAAAA,YAAmB;IAAAA,iBAAK;IAC5BA,0EAIK;IACLA,0EAIK;IACLA,0EAIK;IACPA,iBAAK;;;;;IAjBCA,eAAU;IAAVA,6BAAU;IACVA,eAAmB;IAAnBA,sCAAmB;IAClBA,eAAuC;IAAvCA,uFAAuC;IAKvCA,eAAuC;IAAvCA,uFAAuC;IAKvCA,eAAuC;IAAvCA,uFAAuC;;;;;;IAWhDA,8BAKC;IAHCA;MAAA;MAAA;MAAA;MAAA,OAASA,iEAA8B;IAAA,EAAC;IAIxCA,YACF;IAAAA,iBAAK;;;;;IAHHA,wFAA+D;IAE/DA,eACF;IADEA,0CACF;;;;;IA3CNA,8BAA6C;IAClBA,0BAAU;IAAAA,iBAAM;IACzCA,8BAAuB;IAIXA,kBAAE;IAAAA,iBAAK;IACXA,0BAAI;IAAAA,6BAAY;IAAAA,iBAAK;IACrBA,0BAAqB;IACvBA,iBAAK;IAEPA,8BAAO;IACLA,sEAkBK;IACPA,iBAAQ;IACRA,+BAAuB;IAAAA,aAAwC;IAAAA,iBAAM;IACrEA,+BAAuB;IAAAA,aAAuB;IAAAA,iBAAM;IAEtDA,+BAA0B;IACxBA,sEAOK;IACPA,iBAAK;;;;IAhCiBA,gBAAQ;IAARA,sCAAQ;IAoBLA,eAAwC;IAAxCA,+EAAwC;IACxCA,eAAuB;IAAvBA,uDAAuB;IAM3BA,eAAoC;IAApCA,mFAAoC;;;ACtC/D,OAAM,MAAOC,cAAc;EASzBC,YACUC,WAAwB,EACxBC,WAAwB,EACzBC,WAA4B,EAC3BC,cAA8B,EAC9BC,MAAc;IAJd,gBAAW,GAAXJ,WAAW;IACX,gBAAW,GAAXC,WAAW;IACZ,gBAAW,GAAXC,WAAW;IACV,mBAAc,GAAdC,cAAc;IACd,WAAM,GAANC,MAAM;IAVhB,gBAAW,GAAW,CAAC;IACvB,aAAQ,GAAW,CAAC;IACpB,eAAU,GAAW,CAAC;IACtB,kBAAa,GAAW,CAAC;IA6CzB,gBAAW,GAAIC,KAAa,IAAI;MAC9B,OAAOC,IAAI,CAACC,KAAK,CAACF,KAAK,CAAC;IAC1B,CAAC;IAED,sBAAiB,GAAG,CAACG,IAAY,EAAEC,IAAY,KAAI;MACjD,IAAI,CAACT,WAAW,CAACU,YAAY,CAACF,IAAI,EAAEC,IAAI,CAAC,CAACE,SAAS,CAAC;QAClDC,IAAI,EAAGC,IAAI,IAAI;UACbC,OAAO,CAACC,GAAG,CAACF,IAAI,CAAC;UAEjB,MAAM;YAAEG,OAAO;YAAEC,MAAM;YAAER,IAAI;YAAES,UAAU;YAAEC;UAAa,CAAE,GAAGN,IAAI;UACjE,IAAI,CAACO,KAAK,GAAGJ,OAAO;UACpB,IAAI,CAACK,WAAW,GAAGJ,MAAM;UACzB,IAAI,CAACK,QAAQ,GAAGb,IAAI;UACpB,IAAI,CAACS,UAAU,GAAGA,UAAU;UAC5B,IAAI,CAACC,aAAa,GAAGA,aAAa;QACpC,CAAC;QACDI,KAAK,EAAGA,KAAK,IAAM,IAAI,CAACC,YAAY,GAAGD,KAAK,CAACE;OAC9C,CAAC;IACJ,CAAC;IACD,8BAAyB,GAAG,CAC1BC,UAAkB,EAClBlB,IAAY,EACZC,IAAY,KACV;MACF,IAAI,CAACT,WAAW,CAAC2B,oBAAoB,CAACD,UAAU,EAAElB,IAAI,EAAEC,IAAI,CAAC,CAACE,SAAS,CAAC;QACtEC,IAAI,EAAGC,IAAI,IAAI;UACbC,OAAO,CAACC,GAAG,CAACF,IAAI,CAAC;UACjB,MAAM;YAAEG,OAAO;YAAEC,MAAM;YAAER,IAAI;YAAES,UAAU;YAAEC;UAAa,CAAE,GAAGN,IAAI;UACjE,IAAI,CAACO,KAAK,GAAGJ,OAAO;UACpB,IAAI,CAACK,WAAW,GAAGJ,MAAM;UACzB,IAAI,CAACK,QAAQ,GAAGb,IAAI;UACpB,IAAI,CAACS,UAAU,GAAGA,UAAU;UAC5B,IAAI,CAACC,aAAa,GAAGA,aAAa;QACpC,CAAC;QACDI,KAAK,EAAGA,KAAK,IAAM,IAAI,CAACC,YAAY,GAAGD,KAAK,CAACE;OAC9C,CAAC;IACJ,CAAC;EAzEE;EAEHG,QAAQ;IACN,MAAMC,MAAM,GAAG,IAAI,CAAC1B,cAAc,CAAC2B,QAAQ,CAACD,MAAM;IAClD,IAAI,CAACE,eAAe,GAAG,IAAI,CAAC9B,WAAW,CAAC+B,KAAK,CAAC;MAC5CC,OAAO,EAAE,IAAI,CAAChC,WAAW,CAACiC,OAAO,CAAC,EAAE;KACrC,CAAC;IACF,IAAIL,MAAM,CAAC,IAAI,CAAC,EAAE;MAChB,IAAI,CAACM,yBAAyB,CAC5BC,MAAM,CAACP,MAAM,CAAC,IAAI,CAAC,CAAC,EACpB,IAAI,CAACR,WAAW,EAChB,IAAI,CAACC,QAAQ,CACd;KACF,MAAM;MACL,IAAI,CAACe,iBAAiB,CAAC,IAAI,CAAChB,WAAW,EAAE,IAAI,CAACC,QAAQ,CAAC;;EAE3D;EAEMgB,gBAAgB,CAACC,IAAU;IAAA;IAAA;MAC/B,IAAIC,OAAO,CAAC,2CAA2C,CAAC,EAAE;QACxD,KAAI,CAACxC,WAAW,CAACyC,UAAU,CAACF,IAAK,CAACG,EAAE,CAAC,CAAC/B,SAAS,CAAEgC,CAAC,IAAI;UACpD,KAAI,CAAC3C,WAAW,CACbU,YAAY,CAAC,KAAI,CAACW,WAAW,EAAE,KAAI,CAACC,QAAQ,CAAC,CAC7CX,SAAS,CAAC;YACTC,IAAI,EAAGC,IAAI,IAAI;cACb,MAAM;gBAAEG,OAAO;gBAAEC,MAAM;gBAAER,IAAI;gBAAES,UAAU;gBAAEC;cAAa,CAAE,GAAGN,IAAI;cACjE,KAAI,CAACO,KAAK,GAAGJ,OAAO;cACpB,KAAI,CAACK,WAAW,GAAGJ,MAAM;cACzB,KAAI,CAACK,QAAQ,GAAGb,IAAI;cACpB,KAAI,CAACS,UAAU,GAAGA,UAAU;cAC5B,KAAI,CAACC,aAAa,GAAGA,aAAa;YACpC,CAAC;YACDI,KAAK,EAAGA,KAAK,IAAM,KAAI,CAACC,YAAY,GAAGD,KAAK,CAACE;WAC9C,CAAC;QACN,CAAC,CAAC;;IACH;EACH;EAsCAmB,aAAa;IACX,IAAI,CAACxC,MAAM,CAACyC,aAAa,CAAC,iBAAiB,CAAC;EAC9C;EACAC,cAAc,CAACP,IAAU;IACvB,IAAI,CAACnC,MAAM,CAACyC,aAAa,CAAC,oBAAoBN,IAAI,CAACG,EAAE,EAAE,CAAC;EAC1D;EACAK,cAAc,CAACR,IAAU;IACvB,IAAI,CAACnC,MAAM,CAACyC,aAAa,CAAC,oBAAoBN,IAAI,CAACG,EAAE,EAAE,CAAC;EAC1D;EAAC;qBAjGU5C,cAAc;EAAA;EAAA;UAAdA,cAAc;IAAAkD;IAAAC;IAAAC;IAAAC;IAAAC;MAAA;QDb3BvD,8BAAuB;QACrBA,+DAOM;QACNA,gHAEc;QACdA,gEA8CM;QACRA,iBAAM;;;;QAxDDA,eAAuC;QAAvCA,oFAAuC;QASvBA,eAAa;QAAbA,gCAAa","names":["i0","BillsComponent","constructor","billService","formBuilder","authService","activatedRoute","router","value","Math","round","page","size","getPageBills","subscribe","next","data","console","log","content","number","totalPages","totalElements","bills","currentPage","pageSize","error","errorMessage","message","customerID","getBillsByCustomerId","ngOnInit","params","snapshot","searchFormGroup","group","keyword","control","handleGetCustomerPageBill","Number","handleGetPageBill","handleDeleteBill","bill","confirm","deleteBill","id","d","handleNewBill","navigateByUrl","handleEditBill","handleShowBill","selectors","decls","vars","consts","template"],"sourceRoot":"","sources":["/Users/achrafbilal/Documents/GitHub/tp-controle-spring-boot/front/src/app/bills/bills.component.html","/Users/achrafbilal/Documents/GitHub/tp-controle-spring-boot/front/src/app/bills/bills.component.ts"],"sourcesContent":["<div class=\"container\">\n  <nav\n    class=\"p-2 m-2 border border-info\"\n    *ngIf=\"authService.hasRoleIn([]) || true\"\n  >\n    <button class=\"btn btn-outline-info\" (click)=\"handleNewBill()\">\n      New bill\n    </button>\n  </nav>\n  <ng-template #errors>\n    <div class=\"text-danger\">{{ errorMessage }}</div>\n  </ng-template>\n  <div class=\"card\" *ngIf=\"bills; else errors\">\n    <div class=\"card-header\">Bills List</div>\n    <div class=\"card-body\">\n      <table class=\"table\">\n        <thead>\n          <tr>\n            <th>ID</th>\n            <th>Billing date</th>\n            <th colspan=\"2\"></th>\n          </tr>\n        </thead>\n        <tbody>\n          <tr *ngFor=\"let p of bills\">\n            <td>{{ p.id }}</td>\n            <td>{{ p.billingDate }}</td>\n            <td *ngIf=\"authService.hasRoleIn([]) || true\">\n              <button (click)=\"handleShowBill(p)\" class=\"btn btn-info\">\n                <i class=\"bi bi-eye-fill\"></i>\n              </button>\n            </td>\n            <td *ngIf=\"authService.hasRoleIn([]) || true\">\n              <button (click)=\"handleEditBill(p)\" class=\"btn btn-warning\">\n                <i class=\"bi bi-pencil\"></i>\n              </button>\n            </td>\n            <td *ngIf=\"authService.hasRoleIn([]) || true\">\n              <button (click)=\"handleDeleteBill(p)\" class=\"btn btn-danger\">\n                <i class=\"bi bi-trash\"></i>\n              </button>\n            </td>\n          </tr>\n        </tbody>\n        <div class=\"container\">{{ currentPage + 1 }} / {{ totalPages }}</div>\n        <div class=\"container\">{{ pageSize }} per page</div>\n      </table>\n      <ul class=\"nav nav-pills\">\n        <li\n          class=\"btn ms-1 mt-1\"\n          (click)=\"handleGetPageBill(i, pageSize)\"\n          *ngFor=\"let item of [].constructor(this.totalPages); let i = index\"\n          [ngClass]=\"i === currentPage ? 'btn-info' : 'btn-outline-info'\"\n        >\n          {{ i + 1 }}\n        </li>\n      </ul>\n    </div>\n  </div>\n</div>\n","import { SecurityService } from \"./../services/security.service\";\nimport { Bill, PageBill } from \"./../model/bill.model\";\n\nimport { BillService } from \"./../services/bill.service\";\nimport { Component, OnInit } from \"@angular/core\";\nimport { FormBuilder, FormGroup } from \"@angular/forms\";\nimport { Router, ActivatedRoute } from \"@angular/router\";\n\n@Component({\n  selector: \"app-bills\",\n  templateUrl: \"./bills.component.html\",\n  styleUrls: [\"./bills.component.scss\"],\n})\nexport class BillsComponent implements OnInit {\n  bills!: Array<Bill>;\n  errorMessage!: String;\n  searchFormGroup!: FormGroup;\n  currentPage: number = 0;\n  pageSize: number = 5;\n  totalPages: number = 0;\n  totalElements: number = 0;\n  customerID!: number;\n  constructor(\n    private billService: BillService,\n    private formBuilder: FormBuilder,\n    public authService: SecurityService,\n    private activatedRoute: ActivatedRoute,\n    private router: Router\n  ) {}\n\n  ngOnInit(): void {\n    const params = this.activatedRoute.snapshot.params;\n    this.searchFormGroup = this.formBuilder.group({\n      keyword: this.formBuilder.control(\"\"),\n    });\n    if (params[\"id\"]) {\n      this.handleGetCustomerPageBill(\n        Number(params[\"id\"]),\n        this.currentPage,\n        this.pageSize\n      );\n    } else {\n      this.handleGetPageBill(this.currentPage, this.pageSize);\n    }\n  }\n\n  async handleDeleteBill(bill: Bill) {\n    if (confirm(\"Are you sure you want to delete this bill\")) {\n      this.billService.deleteBill(bill!.id).subscribe((d) => {\n        this.billService\n          .getPageBills(this.currentPage, this.pageSize)\n          .subscribe({\n            next: (data) => {\n              const { content, number, size, totalPages, totalElements } = data;\n              this.bills = content;\n              this.currentPage = number;\n              this.pageSize = size;\n              this.totalPages = totalPages;\n              this.totalElements = totalElements;\n            },\n            error: (error) => (this.errorMessage = error.message),\n          });\n      });\n    }\n  }\n  roundNumber = (value: number) => {\n    return Math.round(value);\n  };\n\n  handleGetPageBill = (page: number, size: number) => {\n    this.billService.getPageBills(page, size).subscribe({\n      next: (data) => {\n        console.log(data);\n\n        const { content, number, size, totalPages, totalElements } = data;\n        this.bills = content;\n        this.currentPage = number;\n        this.pageSize = size;\n        this.totalPages = totalPages;\n        this.totalElements = totalElements;\n      },\n      error: (error) => (this.errorMessage = error.message),\n    });\n  };\n  handleGetCustomerPageBill = (\n    customerID: number,\n    page: number,\n    size: number\n  ) => {\n    this.billService.getBillsByCustomerId(customerID, page, size).subscribe({\n      next: (data) => {\n        console.log(data);\n        const { content, number, size, totalPages, totalElements } = data;\n        this.bills = content;\n        this.currentPage = number;\n        this.pageSize = size;\n        this.totalPages = totalPages;\n        this.totalElements = totalElements;\n      },\n      error: (error) => (this.errorMessage = error.message),\n    });\n  };\n  handleNewBill() {\n    this.router.navigateByUrl(\"/admin/new-bill\");\n  }\n  handleEditBill(bill: Bill) {\n    this.router.navigateByUrl(`/admin/edit-bill/${bill.id}`);\n  }\n  handleShowBill(bill: Bill) {\n    this.router.navigateByUrl(`/admin/show-bill/${bill.id}`);\n  }\n}\n"]},"metadata":{},"sourceType":"module","externalDependencies":[]}